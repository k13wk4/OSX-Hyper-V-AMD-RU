## @file
# Файл патчей config.plist для устаревших версий macOS.
#
# Copyright (c)2021-2025, Goldfish64. All rights reserved.
# Copyright (c)2023-2025, Cory Bennett. All rights reserved.
# SPDX-License-Identifier: BSD-3-Clause
##

# Этот файл расширяет базовые патчи `config.yml` для всех версий macOS.
# @see https://github.com/Qonfused/HyperV-OSX/blob/main/src/config.yml


################################################################################
# Исправления BIOS/прошивки для legacy версий #
################################################################################

Booter:
 Quirks:
 # Требуется для macOS10.12 и старее
  FixupAppleEfiImages: Boolean | true
 # Требуется для macOS10.7 и старее
  AllowRelocationBlock: Boolean | true
  ForceExitBootServices: Boolean | true
 # Требуется для macOS10.6 и старее
  RebuildAppleMemoryMap: Boolean | true

################################################################################
# Исправления ядра для legacy версий #
################################################################################

Kernel:
 Force:
 # Для старых версий macOS некоторые kext'ы могут потребовать принудительной инъекции.
 # Смотрите мануал OpenCore Configuration для деталей.
  - Arch: String | "i386"
    BundlePath: String | "System/Library/Extensions/IONetworkingFamily.kext"
    ExecutablePath: String | "Contents/MacOS/IONetworkingFamily"
    Identifier: String | "com.apple.iokit.IONetworkingFamily"
    MaxKernel: String | "13.99.99"
    PlistPath: String | "Contents/Info.plist"
  - Arch: String | "i386"
    BundlePath: String | "System/Library/Extensions/IOSCSIParallelFamily.kext"
    ExecutablePath: String | "Contents/MacOS/IOSCSIParallelFamily"
    Identifier: String | "com.apple.iokit.IOSCSIParallelFamily"
    MaxKernel: String | "9.0.0"
    PlistPath: String | "Contents/Info.plist"
 Patch:
 # Отключает `_hpet_init`
  - Arch: String | "i386"
    Base: String | "_hpet_init"
    Comment: String | "Отключает _hpet_init из-за отсутствия HPET оборудования"
    Count: Number |1
    Identifier: String | "kernel"
    MaxKernel: String | "9.5.99"
    Replace: Data | <C3>
 # Отключает `IOHIDDeviceShim::newTransportString()`
  - Arch: String | "i386"
    Base: String | "__ZNK15IOHIDDeviceShim18newTransportStringEv"
    Comment: String | "Исправляет падение в IOHIDDeviceShim::newTransportString(), вызванное NULL _deviceType"
    Count: Number |1
    Identifier: String | "com.apple.iokit.IOHIDFamily"
    MaxKernel: String | "9.6.99"
    MinKernel: String | "9.4.0"
    Replace: Data | <31C0C3>
 # Отключает коэффициент масштабирования для перемещения мыши по X/Y
  - Arch: String | "i386"
    Base: String | "__ZN16IOHIDEventDriver21handleInterruptReportE12UnsignedWideP18IOMemoryDescriptor15IOHIDReportTypem"
    Comment: String | "Обход отсутствия AbsoluteAxisBoundsRemovalPercentage в10.4"
    Identifier: String | "com.apple.iokit.IOHIDFamily"
    Find: Data | <BA1F85EB51>
    MaxKernel: String | "8.11.99"
    MinKernel: String | "8.0.0"
    Replace: Data | <BA00000000>
